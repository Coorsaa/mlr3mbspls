<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-Block Sparse Partial Least Squares for mlr3 • mlr3mbspls</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Multi-Block Sparse Partial Least Squares for mlr3">
<meta property="og:description" content="Integration of multi-block sparse partial least squares (MB-sPLS) with the mlr3 machine learning framework. This package provides custom PipeOp components for MB-sPLS projection and dimensionality reduction in multi-block data analysis workflows, with support for supervised and unsupervised pipelines. It contains a complete native implementation of the MB-sPLS algorithm, fully integrated with the mlr3 ecosystem.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mlr3mbspls</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/quickstart.html">Quick Start with mlr3mbspls</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/coorsaa/mlr3mbspls/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="mlr3mbspls-multi-block-sparse-pls-for-mlr3">mlr3mbspls: Multi-Block Sparse PLS for mlr3<a class="anchor" aria-label="anchor" href="#mlr3mbspls-multi-block-sparse-pls-for-mlr3"></a>
</h1></div>
<div align="center">
<p><a href="https://github.com/coorsaa/mlr3mbspls/actions/workflows/r-cmd-check.yml" class="external-link"><img src="https://github.com/coorsaa/mlr3mbspls/actions/workflows/r-cmd-check.yml/badge.svg" alt="r-cmd-check"></a> <a href="https://github.com/coorsaa/mlr3mbspls/actions/workflows/no-suggest-cmd-check.yml" class="external-link"><img src="https://github.com/coorsaa/mlr3mbspls/actions/workflows/no-suggest-cmd-check.yml/badge.svg" alt="no-suggest-cmd-check"></a> <a href="https://github.com/coorsaa/mlr3mbspls/actions/workflows/pkgdown.yml" class="external-link"><img src="https://github.com/coorsaa/mlr3mbspls/actions/workflows/pkgdown.yml/badge.svg" alt="pkgdown"></a></p>
</div>
<p><code>mlr3mbspls</code> integrates <strong>multi-block sparse partial least squares (MB-sPLS)</strong> with the mlr3 ecosystem: pipelines, tuning, resampling, custom measures, rich visualisations, bootstrap stability selection, prediction‑side validation and nested CV utilities. A high‑performance C++/Armadillo backend powers the core algorithms (training + test EV, permutation, bootstrap, sparsity by block/component, deflation).</p>
<div class="section level2">
<h2 id="highlights">Highlights<a class="anchor" aria-label="anchor" href="#highlights"></a>
</h2>
<div class="section level3">
<h3 id="multi-block-representation-learning">Multi-Block Representation Learning<a class="anchor" aria-label="anchor" href="#multi-block-representation-learning"></a>
</h3>
<ul>
<li>Sequential orthogonal MB‑sPLS with per‑block L¹ sparsity (vector or full <code>c_matrix</code>)</li>
<li>Two optimisation targets: mean absolute correlation (MAC) or Frobenius norm</li>
<li>Training‑time permutation early stopping (per component)</li>
<li>Prediction‑side validation: permutation or bootstrap inference on latent correlation</li>
<li>Block‑wise explained variance (EV) + per‑component EV on train &amp; test</li>
</ul>
</div>
<div class="section level3">
<h3 id="pipeline-components-pipeops">Pipeline Components (PipeOps)<a class="anchor" aria-label="anchor" href="#pipeline-components-pipeops"></a>
</h3>
<ul>
<li>
<code>PipeOpMBsPLS</code> – main transformer (produces per‑block latent scores <code>LVk_block</code>)</li>
<li>
<code>PipeOpMBsPLSBootstrapSelect</code> – post‑hoc bootstrap feature &amp; component selection (CI or frequency method) with component re‑numbering</li>
<li>
<code>PipeOpMBsPCA</code> – multi‑block sparse PCA analogue</li>
<li>
<code>PipeOpMBsPLSXY</code> – supervised XY variant</li>
<li>
<code>PipeOpBlockScaling</code> – unit sum‑of‑squares or feature‑wise scaling / z‑scoring (optionally divide by √p)</li>
<li>
<code>PipeOpSiteCorrection</code> – multi‑block site/batch correction (methods defined per site variable)</li>
<li>
<code>PipeOpFeatureSuffix</code> – systematic feature renaming</li>
<li>
<code>PipeOpTargetLabelFilter</code> – target label filtering convenience op</li>
</ul>
</div>
<div class="section level3">
<h3 id="learners--imputation-helpers">Learners &amp; Imputation Helpers<a class="anchor" aria-label="anchor" href="#learners--imputation-helpers"></a>
</h3>
<ul>
<li>
<code>LearnerClassifKNNGower</code>, <code>LearnerRegrKNNGower</code> – kNN using Gower distance for mixed types</li>
<li>
<code><a href="reference/impute_knn_graph.html">impute_knn_graph()</a></code> – two‑step numeric/factor kNN imputation graph using above learners</li>
</ul>
</div>
<div class="section level3">
<h3 id="tuning--orchestration">Tuning &amp; Orchestration<a class="anchor" aria-label="anchor" href="#tuning--orchestration"></a>
</h3>
<ul>
<li>
<code>TunerSeqMBsPLS</code>, <code>TunerSeqMBsPCA</code> – sequential component‑wise tuning (progressively add components)</li>
<li>Sparse hyper‑parameters exposed with consistent <code>c_&lt;block&gt;</code> naming or full <code>c_matrix</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="evaluation--stability-tooling">Evaluation &amp; Stability Tooling<a class="anchor" aria-label="anchor" href="#evaluation--stability-tooling"></a>
</h3>
<ul>
<li>Measures: <code>MeasureMBsPLS_MAC</code>, <code>MeasureMBsPLS_EV</code>, <code>MeasureMBsPLS_BlockEV</code>, <code>MeasureMBsPLS_EVWeightedMAC</code>, <code>MeasureMBSPCAMEV</code>
</li>
<li>
<code><a href="reference/compute_test_ev.html">compute_test_ev()</a></code>, <code><a href="reference/compute_pipeop_test_ev.html">compute_pipeop_test_ev()</a></code> – EV + objective on new data</li>
<li>
<code><a href="reference/mbspls_flip_weights.html">mbspls_flip_weights()</a></code> – deterministic reorientation (sign alignment)</li>
<li>
<code><a href="reference/mbspls_extract_bootstrap_means.html">mbspls_extract_bootstrap_means()</a></code> – summarise bootstrap runs</li>
<li>
<code><a href="reference/mbspls_plot_block_weight_ci.html">mbspls_plot_block_weight_ci()</a></code> – block weight CIs</li>
<li>Aggregation helpers: <code><a href="reference/aggregate_mbspls_payloads.html">aggregate_mbspls_payloads()</a></code>, <code><a href="reference/collect_mbspls_nested_cv.html">collect_mbspls_nested_cv()</a></code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="higher-level-graph-utilities">Higher Level Graph Utilities<a class="anchor" aria-label="anchor" href="#higher-level-graph-utilities"></a>
</h3>
<ul>
<li>
<code><a href="reference/mbspls_preproc_graph.html">mbspls_preproc_graph()</a></code> – canonical preprocessing (type conversion → encoding → kNN impute → site correction → scaling)</li>
<li>
<code><a href="reference/mbspls_graph_learner.html">mbspls_graph_learner()</a></code> – end‑to‑end GraphLearner constructor (preproc → MB‑sPLS → optional bootstrap selection → downstream learner)</li>
</ul>
</div>
<div class="section level3">
<h3 id="resampling--batch-infrastructure">Resampling &amp; Batch Infrastructure<a class="anchor" aria-label="anchor" href="#resampling--batch-infrastructure"></a>
</h3>
<ul>
<li>
<code><a href="reference/mbspls_nested_cv.html">mbspls_nested_cv()</a></code> – nested CV (inner tuning budget + outer evaluation)</li>
<li>
<code><a href="reference/mbspls_nested_cv_batchtools.html">mbspls_nested_cv_batchtools()</a></code> – batchtools backend variant</li>
</ul>
</div>
<div class="section level3">
<h3 id="visualisation-s3-autoplot-on-graphlearner">Visualisation (S3 Autoplot on <code>GraphLearner</code>)<a class="anchor" aria-label="anchor" href="#visualisation-s3-autoplot-on-graphlearner"></a>
</h3>
<p>Types include: weights (raw / stability‑filtered), variance, scree, correlation heatmap, network, scores, block EV trajectories, bootstrap diagnostics.</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Development version</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"coorsaa/mlr3mbspls"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Core dependencies (install if missing)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mlr3"</span>,<span class="st">"mlr3pipelines"</span>,<span class="st">"mlr3cluster"</span>,<span class="st">"data.table"</span>,<span class="st">"ggplot2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Optional: network plots require <code>igraph</code> + <code>ggraph</code>.</p>
</div>
<div class="section level2">
<h2 id="quick-start-unsupervised-multi-block-latent-space">Quick Start (Unsupervised Multi-Block Latent Space)<a class="anchor" aria-label="anchor" href="#quick-start-unsupervised-multi-block-latent-space"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3.mlr-org.com" class="external-link">mlr3</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3pipelines.mlr-org.com" class="external-link">mlr3pipelines</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3cluster.mlr-org.com" class="external-link">mlr3cluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3.mlr-org.com" class="external-link">mlr3mbspls</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3viz.mlr-org.com" class="external-link">mlr3viz</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="va">clinical</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span>,  ncol <span class="op">=</span> <span class="fl">5</span>,  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"clinical_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">genomics</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">20</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">20</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">metabol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">15</span><span class="op">)</span>,  ncol <span class="op">=</span> <span class="fl">15</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"metabol_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>, <span class="va">clinical</span>, <span class="va">genomics</span>, <span class="va">metabol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">blocks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  clinical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^clinical_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  genomics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^gene_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  metabol  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^metabol_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">task</span> <span class="op">=</span> <span class="va"><a href="https://mlr3cluster.mlr-org.com/reference/TaskClust.html" class="external-link">TaskClust</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"mb"</span>, backend <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="va">task</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">feature_names</span>, <span class="st">"id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">graph</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"blockscale"</span>, param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>blocks <span class="op">=</span> <span class="va">blocks</span>, method <span class="op">=</span> <span class="st">"unit_ssq"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com/reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"mbspls"</span>, blocks <span class="op">=</span> <span class="va">blocks</span>, ncomp <span class="op">=</span> <span class="fl">3L</span>, performance_metric <span class="op">=</span> <span class="st">"mac"</span><span class="op">)</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com/reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"learner"</span>, learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"clust.kmeans"</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gl</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span><span class="va">gl</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">=</span> <span class="va">gl</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl</span>, type <span class="op">=</span> <span class="st">"mbspls_weights"</span>, source <span class="op">=</span> <span class="st">"weights"</span>, top_n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl</span>, type <span class="op">=</span> <span class="st">"mbspls_variance"</span>, show_total <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl</span>, type <span class="op">=</span> <span class="st">"mbspls_heatmap"</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, absolute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prediction-side-validation--bootstrap-selection">Prediction-Side Validation &amp; Bootstrap Selection<a class="anchor" aria-label="anchor" href="#prediction-side-validation--bootstrap-selection"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Optional: parallel bootstrap selection (cross-platform) via future</span></span>
<span><span class="co"># install.packages(c("future", "future.apply"))</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"future"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="fu">future</span><span class="fu">::</span><span class="va"><a href="https://future.futureverse.org/reference/multisession.html" class="external-link">multisession</a></span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="co"># future::plan(future::sequential)  # reset when done</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">log_env</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">graph_sel</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"blockscale"</span>, param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>blocks <span class="op">=</span> <span class="va">blocks</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com/reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"mbspls"</span>, blocks <span class="op">=</span> <span class="va">blocks</span>, ncomp <span class="op">=</span> <span class="fl">4L</span>, performance_metric <span class="op">=</span> <span class="st">"mac"</span>,</span>
<span>     permutation_test <span class="op">=</span> <span class="cn">TRUE</span>, n_perm <span class="op">=</span> <span class="fl">200L</span>, perm_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>     val_test <span class="op">=</span> <span class="st">"permutation"</span>, val_test_n <span class="op">=</span> <span class="fl">500L</span>, val_test_alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>     append <span class="op">=</span> <span class="cn">TRUE</span>,               <span class="co"># expose upstream LV columns to selection op</span></span>
<span>     store_train_blocks <span class="op">=</span> <span class="cn">TRUE</span>,   <span class="co"># pass original blocks for bootstrap</span></span>
<span>     log_env <span class="op">=</span> <span class="va">log_env</span><span class="op">)</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com/reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"mbspls_bootstrap_select"</span>, log_env <span class="op">=</span> <span class="va">log_env</span>, bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     B <span class="op">=</span> <span class="fl">200L</span>, selection_method <span class="op">=</span> <span class="st">"ci"</span>, align <span class="op">=</span> <span class="st">"block_sign"</span>,</span>
<span>     workers <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span> <span class="op"><a href="https://mlr3pipelines.mlr-org.com/reference/grapes-greater-than-greater-than-grapes.html" class="external-link">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"learner"</span>, learner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"clust.kmeans"</span>, centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gl_sel</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_learner.html" class="external-link">as_learner</a></span><span class="op">(</span><span class="va">graph_sel</span><span class="op">)</span></span>
<span><span class="va">gl_sel</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stable (post-selection) latent columns now in the task representation</span></span>
<span><span class="va">gl_sel</span><span class="op">$</span><span class="va">model</span><span class="op">$</span><span class="va">mbspls_bootstrap_select</span><span class="op">$</span><span class="va">kept_blocks_per_comp</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="higher-level-convenience-graph">Higher Level Convenience Graph<a class="anchor" aria-label="anchor" href="#higher-level-convenience-graph"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Site / batch effect correction example ---</span></span>
<span><span class="co"># PipeOpSiteCorrection supports per-block methods: "partial_corr", "combat", "dir".</span></span>
<span><span class="co"># For "combat" supply a list with elements site=&lt;char1&gt;, covariates=&lt;char_vec&gt;.</span></span>
<span><span class="co"># For "partial_corr" supply a character vector of (site + optional covariates) columns.</span></span>
<span></span>
<span><span class="co"># Add mock site / batch / covariate columns to the data (if not already present)</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">site</span>  <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>,<span class="st">"S2"</span>,<span class="st">"S3"</span><span class="op">)</span>, <span class="va">.N</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">batch</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>,<span class="st">"B2"</span><span class="op">)</span>,   <span class="va">.N</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">age</span>   <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">.N</span>, <span class="fl">50</span>, <span class="fl">8</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">sex</span>   <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>,<span class="st">"M"</span><span class="op">)</span>, <span class="va">.N</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Update task backend to include new columns</span></span>
<span><span class="va">task</span> <span class="op">=</span> <span class="va"><a href="https://mlr3cluster.mlr-org.com/reference/TaskClust.html" class="external-link">TaskClust</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"mb"</span>, backend <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="va">task</span><span class="op">$</span><span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">task</span><span class="op">$</span><span class="va">feature_names</span>, <span class="st">"id"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Per-block site correction specifications</span></span>
<span><span class="va">site_correction</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  clinical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>site <span class="op">=</span> <span class="st">"site"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"sex"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># ComBat with covariates</span></span>
<span>  genomics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"batch"</span><span class="op">)</span>,                                          <span class="co"># partial correlation on batch</span></span>
<span>  metabol  <span class="op">=</span> <span class="st">"site"</span>                                               <span class="co"># single categorical site (partial_corr)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Corresponding methods per block</span></span>
<span><span class="va">site_correction_methods</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  clinical <span class="op">=</span> <span class="st">"combat"</span>,</span>
<span>  genomics <span class="op">=</span> <span class="st">"partial_corr"</span>,</span>
<span>  metabol  <span class="op">=</span> <span class="st">"partial_corr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optional: use future for parallel bootstrap stability selection</span></span>
<span><span class="co"># future::plan(future::multisession, workers = 4)</span></span>
<span></span>
<span><span class="va">gl_full</span> <span class="op">=</span> <span class="fu"><a href="reference/mbspls_graph_learner.html">mbspls_graph_learner</a></span><span class="op">(</span></span>
<span>  blocks <span class="op">=</span> <span class="va">blocks</span>,</span>
<span>  site_correction <span class="op">=</span> <span class="va">site_correction</span>,</span>
<span>  site_correction_methods <span class="op">=</span> <span class="va">site_correction_methods</span>,</span>
<span>  keep_site_col <span class="op">=</span> <span class="cn">FALSE</span>,      <span class="co"># drop site / covariate columns after correction</span></span>
<span>  ncomp <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  performance_metric <span class="op">=</span> <span class="st">"mac"</span>,</span>
<span>  permutation_test <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_perm <span class="op">=</span> <span class="fl">200L</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  selection_method <span class="op">=</span> <span class="st">"frequency"</span>,</span>
<span>  frequency_threshold <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">gl_full</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">task</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualisation-examples">Visualisation Examples<a class="anchor" aria-label="anchor" href="#visualisation-examples"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3viz.mlr-org.com" class="external-link">mlr3viz</a></span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl_sel</span>, type <span class="op">=</span> <span class="st">"mbspls_weights"</span>, source <span class="op">=</span> <span class="st">"weights"</span>, top_n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl_sel</span>, type <span class="op">=</span> <span class="st">"mbspls_weights"</span>, source <span class="op">=</span> <span class="st">"bootstrap"</span>, alpha_by_stability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl_sel</span>, type <span class="op">=</span> <span class="st">"mbspls_variance"</span>, show_total <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">autoplot</span><span class="op">(</span><span class="va">gl_sel</span>, type <span class="op">=</span> <span class="st">"mbspls_heatmap"</span>, method <span class="op">=</span> <span class="st">"spearman"</span>, absolute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Optional network (needs igraph/ggraph installed)</span></span>
<span><span class="co"># autoplot(gl_sel, type = "mbspls_network", cutoff = 0.1)</span></span></code></pre></div>
<p><code><a href="reference/mbspls_plot_block_weight_ci.html">mbspls_plot_block_weight_ci()</a></code> produces per‑block weight confidence intervals after bootstrap selection:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/mbspls_plot_block_weight_ci.html">mbspls_plot_block_weight_ci</a></span><span class="op">(</span><span class="va">gl_sel</span>, source <span class="op">=</span> <span class="st">"bootstrap"</span>, alpha_by_stability <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="measures">Measures<a class="anchor" aria-label="anchor" href="#measures"></a>
</h2>
<table class="table">
<thead><tr class="header">
<th>Measure Class</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>MeasureMBsPLS_MAC</code></td>
<td>Mean absolute correlation of block scores</td>
</tr>
<tr class="even">
<td><code>MeasureMBsPLS_EV</code></td>
<td>Total explained variance (summed blocks)</td>
</tr>
<tr class="odd">
<td><code>MeasureMBsPLS_BlockEV</code></td>
<td>Per‑block EV matrix access</td>
</tr>
<tr class="even">
<td><code>MeasureMBsPLS_EVWeightedMAC</code></td>
<td>MAC weighted by EV contribution</td>
</tr>
<tr class="odd">
<td><code>MeasureMBSPCAMEV</code></td>
<td>EV (multi‑block sparse PCA)</td>
</tr>
</tbody>
</table>
<p>Use like any mlr3 measure:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"mbspls.mac"</span><span class="op">)</span>, <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"mbspls.ev"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rr</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/resample.html" class="external-link">resample</a></span><span class="op">(</span><span class="va">task</span>, <span class="va">gl</span>, <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"cv"</span>, folds <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, store_models <span class="op">=</span> <span class="cn">TRUE</span>, measures <span class="op">=</span> <span class="va">ms</span><span class="op">)</span></span>
<span><span class="va">rr</span><span class="op">$</span><span class="fu">aggregate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="nested-cross-validation">Nested Cross-Validation<a class="anchor" aria-label="anchor" href="#nested-cross-validation"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mlr3tuning.mlr-org.com" class="external-link">mlr3tuning</a></span><span class="op">)</span></span>
<span><span class="va">res_nested</span> <span class="op">=</span> <span class="fu"><a href="reference/mbspls_nested_cv.html">mbspls_nested_cv</a></span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="va">task</span>,</span>
<span>  graphlearner <span class="op">=</span> <span class="va">gl_full</span>,</span>
<span>  rs_outer <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"cv"</span>, folds <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  rs_inner <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"cv"</span>, folds <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  ncomp <span class="op">=</span> <span class="fl">4L</span>,</span>
<span>  tuner_budget <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  performance_metric <span class="op">=</span> <span class="st">"mac"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res_nested</span><span class="op">)</span></span></code></pre></div>
<p>Batchtools version (for HPC) is available via <code><a href="reference/mbspls_nested_cv_batchtools.html">mbspls_nested_cv_batchtools()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="sequential-component-tuning">Sequential Component Tuning<a class="anchor" aria-label="anchor" href="#sequential-component-tuning"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tuner</span> <span class="op">=</span> <span class="va"><a href="reference/TunerSeqMBsPLS.html">TunerSeqMBsPLS</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">instance</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3tuning.mlr-org.com/reference/ti.html" class="external-link">ti</a></span><span class="op">(</span></span>
<span>  task <span class="op">=</span> <span class="va">task</span>,</span>
<span>  learner <span class="op">=</span> <span class="va">gl_full</span>,</span>
<span>  resampling <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"cv"</span>, folds <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  measures <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"mbspls.mac"</span><span class="op">)</span>,</span>
<span>  terminator <span class="op">=</span> <span class="fu"><a href="https://bbotk.mlr-org.com/reference/trm.html" class="external-link">trm</a></span><span class="op">(</span><span class="st">"evals"</span>, n_evals <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># tuner$optimize(instance)</span></span>
<span><span class="co"># instance$result$learner_param_vals[[1]]$c_matrix</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="useful-low-level-helpers">Useful Low-Level Helpers<a class="anchor" aria-label="anchor" href="#useful-low-level-helpers"></a>
</h2>
<table class="table">
<colgroup>
<col width="66%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Role</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/compute_test_ev.html">compute_test_ev()</a></code></td>
<td>Compute EV + objective on new matrices (standalone)</td>
</tr>
<tr class="even">
<td><code><a href="reference/compute_pipeop_test_ev.html">compute_pipeop_test_ev()</a></code></td>
<td>Same for a PipeOp state representation</td>
</tr>
<tr class="odd">
<td><code><a href="reference/mbspls_eval_new_data.html">mbspls_eval_new_data()</a></code></td>
<td>Score new data given training state (matrix interface)</td>
</tr>
<tr class="even">
<td><code><a href="reference/mbspls_flip_weights.html">mbspls_flip_weights()</a></code></td>
<td>Sign alignment (GraphLearner, PipeOp, list)</td>
</tr>
<tr class="odd">
<td><code><a href="reference/mbspls_extract_bootstrap_means.html">mbspls_extract_bootstrap_means()</a></code></td>
<td>Summarise bootstrap weight means</td>
</tr>
<tr class="even">
<td><code><a href="reference/aggregate_mbspls_payloads.html">aggregate_mbspls_payloads()</a></code></td>
<td>Merge logged payloads (e.g. across resamples)</td>
</tr>
<tr class="odd">
<td><code><a href="reference/collect_mbspls_nested_cv.html">collect_mbspls_nested_cv()</a></code></td>
<td>Collect nested CV payload archives</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="custom-learners-gower-knn">Custom Learners (Gower kNN)<a class="anchor" aria-label="anchor" href="#custom-learners-gower-knn"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_cls</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"classif.knngower"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">knn_reg</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"regr.knngower"</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>These are used implicitly inside <code><a href="reference/impute_knn_graph.html">impute_knn_graph()</a></code> and can be part of supervised pipelines downstream of MB‑sPLS/MB‑sPCA representations.</p>
</div>
<div class="section level2">
<h2 id="reproducible-sparsity-specification">Reproducible Sparsity Specification<a class="anchor" aria-label="anchor" href="#reproducible-sparsity-specification"></a>
</h2>
<p>Two options:</p>
<ol style="list-style-type: decimal">
<li>Per‑block constraints automatically created: parameters named <code>c_&lt;block&gt;</code> with default upper bound √p.</li>
<li>Provide a <code>c_matrix</code> (rows = blocks, cols = components) – overrides <code>ncomp</code> and per‑block <code>c_</code> values.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph_cmat</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"mbspls"</span>, blocks <span class="op">=</span> <span class="va">blocks</span>, c_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vignette">Vignette<a class="anchor" aria-label="anchor" href="#vignette"></a>
</h2>
<p>See the Quickstart vignette for an end‑to‑end multi‑omics example:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"quickstart"</span>, package <span class="op">=</span> <span class="st">"mlr3mbspls"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>mlr3mbspls</code> in academic work please cite:</p>
<pre><code>@Manual{mlr3mbspls,
  title = {mlr3mbspls: Multi-Block Sparse PLS for mlr3},
  author = {Stefan Coors and Clara Sophie Vetter},
  year = {2025},
  note = {R package version 0.2.12},
  url = {https://github.com/coorsaa/mlr3mbspls}
}</code></pre>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>Issues &amp; PRs welcome. Please open an issue for substantial interface changes before implementing. Run <code>pre-commit</code> hooks + <code>R CMD check</code> locally.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>LGPL-3</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/coorsaa/mlr3mbspls/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/coorsaa/mlr3mbspls/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/LGPL-3" class="external-link">LGPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mlr3mbspls</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefan Coors <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7465-2146" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Clara Sophie Vetter <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-4268-2890" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Stefan Coors, Clara Sophie Vetter.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
